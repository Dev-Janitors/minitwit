FROM node:16.14.2-alpine

WORKDIR /App

COPY ./Frontend ./Frontend

WORKDIR /App/Frontend

RUN yarn set version 1.22.19

RUN yarn

EXPOSE 3000

ENV REACT_APP_API_URL=${{secrets.REACT_APP_API_URL}}

ENV REACT_APP_AUTH0_DOMAIN=${{secrets.REACT_APP_AUTH0_DOMAIN}}
ENV REACT_APP_AUTH0_CLIENT_ID=${{secrets.REACT_APP_AUTH0_CLIENT_ID}}
ENV REACT_APP_AUTH0_CALLBACK_URL=${{secrets.REACT_APP_AUTH0_CALLBACK_URL}}
ENV REACT_APP_API_SERVER_URL=${{secrets.REACT_APP_API_SERVER_URL}}
ENV REACT_APP_AUTH0_AUDIENCE=${{secrets.REACT_APP_AUTH0_AUDIENCE}}

RUN yarn build

RUN yarn global add serve

CMD [ "yarn","serve" ]